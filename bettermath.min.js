"use strict";(function(){var math={};if(typeof window!=="undefined"&&window._){var _=window._}if(typeof _==="undefined"){if(typeof require!=="undefined"){var _=require("lodash")}else{throw new Error("bettermath requires lodash")}}math.isEven=function(obj,key){if(math.isNumber(obj)){return obj%2===0}if(math.isArray(obj)){return math.pluck(obj,key).map(math.isEven)}};math.isOdd=function(obj,key){if(math.isNumber(obj)){return obj%2===1}if(math.isArray(obj)){return math.pluck(obj,key).map(math.isOdd)}};math.isPrime=function(obj,key){if(math.isNumber(obj)){var safeN=Math.abs(Math.round(obj));if(!obj){return false}else if(obj!==2){var goUntil=Math.ceil(Math.sqrt(safeN));for(var i=2;i<=goUntil;i++){if(safeN%i===0){return false}}}return true}if(math.isArray(obj)){return math.pluck(obj,key).map(i=>{return math.isPrime(i)})}};math.square=function(val){return math.pow(val,2)};math.cube=function(val){return math.pow(val,3)};var origPow=Math.pow;math.pow=function(x,n){if(math.isNumber(x)){return origPow(x,n)}if(math.isArray(x)){return x.map(i=>{return math.pow(i,n)})}};math.factorial=function(obj,key){if(math.isNumber(obj)){if(obj<0){return Infinity}else if(obj===0){return 1}else{return math.product(math.range(obj))}}var arr=math.pluck(obj,key);return arr.map(i=>{return math.product(math.range(i))})};math.scale=function(arr,min,max){if(math.isUndefined(min))min=0;if(math.isUndefined(max))max=1;var minArr=Math.min(...arr);var oldRange=Math.max(...arr)-minArr;var newRange=max-min;return arr.map(i=>{return(i-minArr)/oldRange*newRange+min})};math.undirectedEdges=function(obj,key){if(math.isNumber(obj)){return n*(n-1)/2}return math.pluck(obj,key).map(i=>{return math.undirectedEdges(i)})};math.format=function(obj,precision){if(math.isNumber(obj)){return obj.toFixed(precision)/1}return obj.map(i=>{return math.format(i,precision)/1})};math.sort=_.sortBy;math.movingAvg=function(arr,size){var win,i,newarr=[];for(i=size-1;i<=arr.length;i++){win=arr.slice(i-size,i);if(win.length===size){newarr.push(math.mean(win))}}return newarr};math.factors=function(n){var result=[];var startN=Math.abs(Math.round(n));var finished=false;while(!finished){finished=true;for(var i=2;i<=startN/2;i++){if(n%i===0){n/=i;result.push(i);finished=false;break}}}if(result.length===0){result.push(startN)}return result};math.divisors=function(n,opts){var safeN=Math.abs(Math.round(n));if(Math.abs(n)===safeN)opts=opts||{};var result=[1];for(var i=2;i<=safeN/2;i++){if(safeN%i==0){result.push(i)}}if(!opts.proper){result.push(safeN)}return result};math.sum=math.add=function(obj,key){return math.pluck(obj,key).reduce((a,b)=>{return a+b},0)};math.product=math.multiply=function(obj,key){return math.pluck(obj,key).reduce((a,b)=>{return a*b},1)};math.mean=math.average=function(obj,key){var arr=math.pluck(obj,key);return math.sum(arr)/arr.length};math.median=function(obj,key){var arr=math.pluck(obj,key);var middle=(arr.length+1)/2;var sorted=math.sort(arr);return sorted.length%2?sorted[middle-1]:(sorted[middle-1.5]+sorted[middle-.5])/2};math.mode=math.modes=function(obj,key){var arr=math.pluck(obj,key);if(!arr.length)return[];var modeMap={},maxCount=0,modes=[];arr.forEach(val=>{if(!modeMap[val]){modeMap[val]=1}else{modeMap[val]++}if(modeMap[val]>maxCount){modes=[val];maxCount=modeMap[val]}else if(modeMap[val]===maxCount){modes.push(val)}});return modes};math.geometricMean=function(obj,key){var arr=math.pluck(obj,key);return Math.pow(math.product(arr),1/arr.length)};math.variance=function(arr){var mean=math.mean(arr);return math.mean(arr.map(x=>{return math.pow(x-mean,2)}))};math.stdDeviation=math.sigma=function(obj,key){return Math.sqrt(math.variance(math.pluck(obj,key)))};math.meanAbsoluteDeviation=function(obj,key){var arr=math.pluck(obj,key),mean=math.mean(arr);return math.mean(arr.map(n=>{return Math.abs(n-mean)}))},math.zscore=function(obj,key){var arr=math.pluck(obj,key),mean=math.mean(arr),sigma=math.stdDeviation(arr);return arr.map(d=>{return(d-mean)/sigma})};math.isNumber=function(obj){return toString.call(obj)==="[object Number]"};math.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};math.isNaN=function(obj){return math.isNumber(obj)&&obj!==+obj};math.isUndefined=function(obj){return typeof obj==="undefined"};math.isArray=function(obj){return toString.call(obj)==="[object Array]"};math.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};math.pluck=function(obj,key){if(math.isArray(obj)&&typeof obj[0]==="number"){var arr=obj}else{var key=key||"value";var arr=_.map(obj,key)}return arr};math.samesign=function(a,b){return a>=0!==b<0};math.copysign=function(a,b){return math.samesign(a,b)?a:-a};math.gcd=function(a,b){var ref;while(b){ref=[b,a%b],a=ref[0],b=ref[1]}return a};math.lcm=function(a,b){return a/math.gcd(a,b)*b};math.between=function(x,a,b){return a<=x&&x<=b||b<=x&&x<=a};math.range=function(stop,start,step){start=start||1;step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};math.slope=function(a,b){return(a[1]-b[1])/(a[0]-b[0])};math.transpose=function(arr){var trans=[];arr.forEach((row,y)=>{row.forEach((col,x)=>{if(!trans[x])trans[x]=[];trans[x][y]=col})});return trans};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=math}exports.math=math}else{window.math=math}}).call(this);
